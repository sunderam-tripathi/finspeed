(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[575],{3349:(e,t,r)=>{Promise.resolve().then(r.bind(r,9286))},7640:(e,t,r)=>{"use strict";r.d(t,{u:()=>i});let s=r(3542).env.NEXT_PUBLIC_API_URL||"/api/v1";class a{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="".concat(this.baseUrl).concat(e),s={"Content-Type":"application/json"};t.headers&&Object.assign(s,t.headers),this.token&&(s.Authorization="Bearer ".concat(this.token));let a=await fetch(r,{...t,headers:s});if(!a.ok)throw Error((await a.json().catch(()=>({error:"Unknown error"}))).error||"HTTP ".concat(a.status));return a.json()}async register(e,t){let r=await this.request("/auth/register",{method:"POST",body:JSON.stringify({email:e,password:t})});return this.setToken(r.token),r}async login(e,t){let r=await this.request("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})});return this.setToken(r.token),r}async getProducts(e){let t=new URLSearchParams;(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.category_id)&&t.set("category_id",e.category_id.toString()),(null==e?void 0:e.search)&&t.set("search",e.search);let r=t.toString();return this.request("/products".concat(r?"?".concat(r):""))}async getProduct(e){return this.request("/products/".concat(e))}async createProduct(e){return this.request("/admin/products",{method:"POST",body:JSON.stringify(e)})}async updateProduct(e,t){return this.request("/admin/products/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteProduct(e){return this.request("/admin/products/".concat(e),{method:"DELETE"})}async getCategories(e){let t=new URLSearchParams;(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.search)&&t.set("search",e.search);let r=t.toString();return this.request("/categories".concat(r?"?".concat(r):""))}async getCategory(e){return this.request("/categories/".concat(e))}async createCategory(e){return this.request("/admin/categories",{method:"POST",body:JSON.stringify(e)})}async updateCategory(e,t){return this.request("/admin/categories/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteCategory(e){return this.request("/admin/categories/".concat(e),{method:"DELETE"})}async getCart(){return this.request("/cart")}async addToCart(e,t){return this.request("/cart/items",{method:"POST",body:JSON.stringify({product_id:e,qty:t})})}async updateCartItem(e,t){return this.request("/cart/items/".concat(e),{method:"PUT",body:JSON.stringify({qty:t})})}async removeFromCart(e){return this.request("/cart/items/".concat(e),{method:"DELETE"})}async clearCart(){return this.request("/cart",{method:"DELETE"})}async getOrders(e){let t=new URLSearchParams;(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString());let r=t.toString();return this.request("/orders".concat(r?"?".concat(r):""))}async getOrder(e){return this.request("/orders/".concat(e))}async createOrder(e,t){return this.request("/orders",{method:"POST",body:JSON.stringify({items:e,shipping_address:t})})}async healthCheck(){return this.request("/healthz")}async getUsers(e){let t=new URLSearchParams;(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.search)&&t.set("search",e.search);let r=t.toString();return this.request("/admin/users".concat(r?"?".concat(r):""))}async getUser(e){return this.request("/admin/users/".concat(e))}async updateUser(e,t){return this.request("/admin/users/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteUser(e){return this.request("/admin/users/".concat(e),{method:"DELETE"})}setToken(e){this.token=e,localStorage.setItem("finspeed_token",e)}clearToken(){this.token=null,localStorage.removeItem("finspeed_token")}getToken(){return this.token}isAuthenticated(){return!!this.token}constructor(){this.token=null,this.baseUrl=s,this.token=localStorage.getItem("finspeed_token")}}let i=new a},9286:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var s=r(881),a=r(5701),i=r(7640);function n(e){let{product:t,onClose:r,onSave:n}=e,[c,o]=(0,a.useState)(t||{title:"",slug:"",price:0,stock_qty:0,category_id:null,sku:null}),[l,d]=(0,a.useState)([]);(0,a.useEffect)(()=>{(async()=>{try{let e=await i.u.getCategories();d(e.categories)}catch(e){d([])}})()},[]);let u=e=>{let{name:t,value:r}=e.target;o(e=>{switch(t){case"price":return{...e,price:Number(r)};case"stock_qty":return{...e,stock_qty:Number(r)};case"category_id":return{...e,category_id:""===r?null:Number(r)};case"sku":return{...e,sku:""===r.trim()?null:r};case"title":return{...e,title:r};case"slug":return{...e,slug:r};default:return e}})};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,s.jsxs)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[(0,s.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:t.id?"Edit Product":"Add Product"}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),n(c)},className:"mt-4 space-y-4",children:[(0,s.jsx)("input",{type:"text",name:"title",value:c.title,onChange:u,placeholder:"Title",className:"w-full p-2 border rounded"}),(0,s.jsx)("input",{type:"text",name:"slug",value:c.slug,onChange:u,placeholder:"Slug",className:"w-full p-2 border rounded"}),(0,s.jsx)("input",{type:"number",name:"price",value:c.price,onChange:u,placeholder:"Price",className:"w-full p-2 border rounded"}),(0,s.jsx)("input",{type:"text",name:"sku",value:c.sku||"",onChange:u,placeholder:"SKU",className:"w-full p-2 border rounded"}),(0,s.jsx)("input",{type:"number",name:"stock_qty",value:c.stock_qty,onChange:u,placeholder:"Stock Quantity",className:"w-full p-2 border rounded"}),(0,s.jsxs)("select",{name:"category_id",value:c.category_id||"",onChange:u,className:"w-full p-2 border rounded",children:[(0,s.jsx)("option",{value:"",children:"Select Category"}),l.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Save"})]})]})]})}):null}function c(){let[e,t]=(0,a.useState)([]),[r,c]=(0,a.useState)(!0),[o,l]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[m,p]=(0,a.useState)(0),[y,x]=(0,a.useState)(1),[b]=(0,a.useState)(10),[f,v]=(0,a.useState)(""),N=(0,a.useCallback)(async(e,r)=>{c(!0);try{var s;let a=await i.u.getProducts({page:e,limit:b,search:r||void 0});t((a.products||[]).map(e=>{var t,r;return{id:e.id,title:e.title,slug:e.slug,price:e.price,stock_qty:e.stock_qty,category_id:null!=(t=e.category_id)?t:null,sku:null!=(r=e.sku)?r:null}})),p(a.total||0),x(null!=(s=a.page)?s:e),l(null)}catch(e){l(e instanceof Error?e.message:"Failed to fetch products")}finally{c(!1)}},[b]);(0,a.useEffect)(()=>{let e=setTimeout(()=>{N(y,f)},500);return()=>clearTimeout(e)},[N,y,f]);let k=()=>{u(!1),g(null)},w=async e=>{if(window.confirm("Are you sure you want to delete this product?"))try{await i.u.deleteProduct(e),await N(y,f)}catch(e){l(e instanceof Error?e.message:"Failed to delete product")}},S=async e=>{try{var t;let r={title:e.title,slug:e.slug,price:Number(e.price),stock_qty:Number(e.stock_qty),sku:e.sku&&""!==e.sku.trim()?e.sku:void 0,category_id:null!=(t=e.category_id)?t:void 0};e.id?await i.u.updateProduct(e.id,r):await i.u.createProduct({...r,currency:"INR"}),k(),await N(y,f)}catch(e){l(e instanceof Error?e.message:"Failed to save product")}};return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Products"}),(0,s.jsx)("button",{onClick:()=>{g({id:0,title:"",slug:"",price:0,stock_qty:0,category_id:null,sku:""}),u(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Add Product"})]}),(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("input",{type:"text",placeholder:"Search products by name, SKU, or slug...",value:f,onChange:e=>v(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),r&&(0,s.jsx)("p",{children:"Loading products..."}),o&&(0,s.jsxs)("p",{className:"text-red-500",children:["Error: ",o]}),!r&&!o&&(0,s.jsx)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),(0,s.jsx)("th",{scope:"col",className:"relative px-6 py-3",children:(0,s.jsx)("span",{className:"sr-only",children:"Edit"})})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.title}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.sku||"N/A"}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["$",e.price.toFixed(2)]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.stock_qty}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,s.jsx)("button",{onClick:()=>{g(e),u(!0)},className:"text-indigo-600 hover:text-indigo-900",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>w(e.id),className:"text-red-600 hover:text-red-900 ml-4",children:"Delete"})]})]},e.id))})]})}),!r&&!o&&m>b&&(0,s.jsxs)("div",{className:"mt-6 flex justify-center items-center",children:[(0,s.jsx)("button",{onClick:()=>x(e=>Math.max(e-1,1)),disabled:1===y,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),(0,s.jsxs)("span",{className:"mx-4 text-sm text-gray-600",children:["Page ",y," of ",Math.ceil(m/b)]}),(0,s.jsx)("button",{onClick:()=>x(e=>e*b<m?e+1:e),disabled:y*b>=m,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:"Next"})]}),d&&h&&(0,s.jsx)(n,{product:h,onClose:k,onSave:S})]})}}},e=>{e.O(0,[803,447,358],()=>e(e.s=3349)),_N_E=e.O()}]);