(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[733],{7640:(e,t,s)=>{"use strict";s.d(t,{u:()=>i});let r=s(3542).env.NEXT_PUBLIC_API_URL||"/api/v1";class a{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="".concat(this.baseUrl).concat(e),r={"Content-Type":"application/json"};t.headers&&Object.assign(r,t.headers),this.token&&(r.Authorization="Bearer ".concat(this.token));let a=await fetch(s,{...t,headers:r});if(!a.ok)throw Error((await a.json().catch(()=>({error:"Unknown error"}))).error||"HTTP ".concat(a.status));return a.json()}async register(e,t){let s=await this.request("/auth/register",{method:"POST",body:JSON.stringify({email:e,password:t})});return this.setToken(s.token),s}async login(e,t){let s=await this.request("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})});return this.setToken(s.token),s}async getProducts(e){let t=new URLSearchParams;(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.category_id)&&t.set("category_id",e.category_id.toString()),(null==e?void 0:e.search)&&t.set("search",e.search);let s=t.toString();return this.request("/products".concat(s?"?".concat(s):""))}async getProduct(e){return this.request("/products/".concat(e))}async createProduct(e){return this.request("/admin/products",{method:"POST",body:JSON.stringify(e)})}async updateProduct(e,t){return this.request("/admin/products/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteProduct(e){return this.request("/admin/products/".concat(e),{method:"DELETE"})}async getCategories(e){let t=new URLSearchParams;(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.search)&&t.set("search",e.search);let s=t.toString();return this.request("/categories".concat(s?"?".concat(s):""))}async getCategory(e){return this.request("/categories/".concat(e))}async createCategory(e){return this.request("/admin/categories",{method:"POST",body:JSON.stringify(e)})}async updateCategory(e,t){return this.request("/admin/categories/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteCategory(e){return this.request("/admin/categories/".concat(e),{method:"DELETE"})}async getCart(){return this.request("/cart")}async addToCart(e,t){return this.request("/cart/items",{method:"POST",body:JSON.stringify({product_id:e,qty:t})})}async updateCartItem(e,t){return this.request("/cart/items/".concat(e),{method:"PUT",body:JSON.stringify({qty:t})})}async removeFromCart(e){return this.request("/cart/items/".concat(e),{method:"DELETE"})}async clearCart(){return this.request("/cart",{method:"DELETE"})}async getOrders(e){let t=new URLSearchParams;(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString());let s=t.toString();return this.request("/orders".concat(s?"?".concat(s):""))}async getOrder(e){return this.request("/orders/".concat(e))}async createOrder(e,t){return this.request("/orders",{method:"POST",body:JSON.stringify({items:e,shipping_address:t})})}async healthCheck(){return this.request("/healthz")}async getUsers(e){let t=new URLSearchParams;(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.search)&&t.set("search",e.search);let s=t.toString();return this.request("/admin/users".concat(s?"?".concat(s):""))}async getUser(e){return this.request("/admin/users/".concat(e))}async updateUser(e,t){return this.request("/admin/users/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteUser(e){return this.request("/admin/users/".concat(e),{method:"DELETE"})}setToken(e){this.token=e,localStorage.setItem("finspeed_token",e)}clearToken(){this.token=null,localStorage.removeItem("finspeed_token")}getToken(){return this.token}isAuthenticated(){return!!this.token}constructor(){this.token=null,this.baseUrl=r,this.token=localStorage.getItem("finspeed_token")}}let i=new a},7806:(e,t,s)=>{Promise.resolve().then(s.bind(s,9468))},9468:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(881),a=s(5701);function i(e){let{isOpen:t,onClose:s,onSave:i,user:n}=e,[o,c]=(0,a.useState)(""),[l,d]=(0,a.useState)("customer");return((0,a.useEffect)(()=>{n?(c(n.email),d(n.role)):(c(""),d("customer"))},[n]),t)?(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,r.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,r.jsxs)("div",{className:"mt-3 text-center",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:n?"Edit User":"Add User"}),(0,r.jsxs)("div",{className:"mt-2 px-7 py-3",children:[(0,r.jsx)("input",{type:"email",placeholder:"Email",value:o,onChange:e=>c(e.target.value),className:"mb-3 px-3 py-2 text-gray-700 bg-gray-100 rounded-md w-full"}),(0,r.jsxs)("select",{value:l,onChange:e=>d(e.target.value),className:"mb-3 px-3 py-2 text-gray-700 bg-gray-100 rounded-md w-full",children:[(0,r.jsx)("option",{value:"customer",children:"Customer"}),(0,r.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,r.jsxs)("div",{className:"items-center px-4 py-3",children:[(0,r.jsx)("button",{onClick:()=>{n&&i({...n,email:o,role:l})},className:"px-4 py-2 bg-indigo-500 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-indigo-300",children:"Save"}),(0,r.jsx)("button",{onClick:s,className:"mt-3 px-4 py-2 bg-gray-200 text-gray-800 text-base font-medium rounded-md w-full shadow-sm hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-300",children:"Cancel"})]})]})})}):null}var n=s(7640);function o(){let[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)(!0),[c,l]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)(null),[g,y]=(0,a.useState)(0),[p,x]=(0,a.useState)(1),[f]=(0,a.useState)(10),[b,v]=(0,a.useState)(""),w=(0,a.useCallback)(async(e,s)=>{o(!0);try{let r=await n.u.getUsers({page:e,limit:f,search:s||void 0});t(r.users||[]),y(r.total||0),x(r.page||e),l(null)}catch(e){l(e instanceof Error?e.message:"Failed to fetch users")}finally{o(!1)}},[f]);(0,a.useEffect)(()=>{let e=setTimeout(()=>{w(p,b)},500);return()=>clearTimeout(e)},[w,p,b]);let S=()=>{m(null),u(!1)},N=async e=>{try{await n.u.updateUser(e.id,{email:e.email,role:e.role}),await w(p,b),S()}catch(e){l(e instanceof Error?e.message:"Failed to update user")}},j=async e=>{if(window.confirm("Are you sure you want to delete this user?"))try{await n.u.deleteUser(e),await w(p,b)}catch(e){l(e instanceof Error?e.message:"Failed to delete user")}};return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Users"})}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("input",{type:"text",placeholder:"Search users by email...",value:b,onChange:e=>v(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),s&&(0,r.jsx)("p",{children:"Loading users..."}),c&&(0,r.jsxs)("p",{className:"text-red-500",children:["Error: ",c]}),!s&&!c&&(0,r.jsx)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,r.jsx)("th",{scope:"col",className:"relative px-6 py-3",children:(0,r.jsx)("span",{className:"sr-only",children:"Edit"})})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.email}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.role}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,r.jsx)("button",{onClick:()=>{m(e),u(!0)},className:"text-indigo-600 hover:text-indigo-900",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>j(e.id),className:"text-red-600 hover:text-red-900 ml-4",children:"Delete"})]})]},e.id))})]})}),!s&&!c&&g>f&&(0,r.jsxs)("div",{className:"mt-6 flex justify-center items-center",children:[(0,r.jsx)("button",{onClick:()=>x(e=>Math.max(e-1,1)),disabled:1===p,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),(0,r.jsxs)("span",{className:"mx-4 text-sm text-gray-600",children:["Page ",p," of ",Math.ceil(g/f)]}),(0,r.jsx)("button",{onClick:()=>x(e=>e*f<g?e+1:e),disabled:p*f>=g,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:"Next"})]}),(0,r.jsx)(i,{isOpen:d,onClose:S,onSave:N,user:h})]})}}},e=>{e.O(0,[803,447,358],()=>e(e.s=7806)),_N_E=e.O()}]);